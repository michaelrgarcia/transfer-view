/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var e={};function t(e,t,n){const o=document.createElement("option");return o.textContent=e,o.value=e,t&&n&&o.setAttribute(`data-${n}`,t),o}function n(e){const t=document.createElement("option");return t.textContent=`Select a ${e}`,t.value="",t.disabled=!0,t.selected=!0,t}function o(e,t){const n=document.createElement("p");n.textContent=e,t.appendChild(n)}e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var o=n.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=o[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),e.p,e.p,e.p,e.p,e.p;const r=e=>{const t=(e=e.trim()).match("[0-9.]+");let n,o="ms";const r=t?t[0]:"";return r&&(o=e.split(r)[1],n=Number(r)),{num:n,unit:o}},c=function(e){const t=function(e){const t=t=>{return window.getComputedStyle(e).getPropertyValue(t)||e.style[(n=t,n.replace(/-([a-z])/g,(e=>e[1].toUpperCase())))];var n},n=t("transition-delay")||"0ms",o=t("transition-duration")||"0ms",c=Array.isArray(o)?o:[o],s=Array.isArray(n)?n:[n];let a,i=0;return c.push.apply(c,s),c.forEach((e=>{e.split(",").forEach((e=>{e=(e=>{const t=r(e),n=t?t.num:void 0;if(!n)return"";let o=n;return"s"===e.replace(n+"","")&&(o=1e3*n),o+"ms"})(e),a=r(e),a.num&&a.num>i&&(i=a.num)}))})),i}(e);return new Promise((n=>{t>0?setTimeout((()=>{n(e)}),t):n(e)}))};function s(e,t){const n=[];return e.forEach(((o,r)=>{n.push(o),r<e.length-1&&n.push(t)})),n}function a(e,t){document.querySelector(".progress-tracker").textContent=`${e} out of ${t} colleges searched`}const i=document.querySelector("dialog"),l=document.querySelector("form"),u=document.querySelector("img.loading-gif"),d=document.querySelector(".results");function p(e){const t=e,n=t.querySelector("select"),o=t.querySelectorAll(":not(.loading)");n&&(n.disabled=!0),o.forEach((e=>{e.setAttribute("aria-disabled","true")}))}function f(e){const t=e,n=t.querySelector("select"),o=t.querySelectorAll(":not(.loading)");n&&(n.disabled=!1),o.forEach((e=>{e.setAttribute("aria-disabled","false")}))}function y(e,t){p(e),function(e){const t=e;t.style.opacity=1,t.style.display="block"}(t)}function m(e,t){f(e),function(e){const t=e;t.style.opacity=0,t.style.display="none"}(t)}async function g(e,t){const n=new Date;try{const o=await fetch(e),r=await o.json(),c=Object.values(r);return localStorage.setItem(t,JSON.stringify(r)),localStorage.setItem("cacheTimestamp",n.toISOString()),c}catch(e){console.error("error caching school data:",e)}return null}function h(e){let t="";return"object"!=typeof e||Array.isArray(e)?Array.isArray(e)&&(t=function(e){let t="";return e.forEach(((e,n)=>{let o;const r=e;if("object"==typeof r){const{prefix:e}=r,{courseNumber:n}=r;t+=` ${e} ${n} `}"string"==typeof r&&(o=r.toLowerCase(),n<r.length-1&&(t+=` ${o} `))})),t}(e)):t=`${e.prefix} ${e.courseNumber} - ${e.courseTitle}`,t}async function w(e,t,o){const r=e.parentNode,c=r.querySelector(".loading");y(r,c);const s=await async function(e,t){try{const n=await async function(e,t){try{const n=`https://cs46plizg2.execute-api.us-east-2.amazonaws.com/74/6/${e}/${t}/lower-divs`,o=await fetch(n),r=await o.json(),c=Object.values(r);return sessionStorage.setItem("selectedLowerDivs",JSON.stringify(r)),c}catch(e){console.log("error fetching lower divs:",e)}return null}(e,t);return n}catch(e){console.error("error retrieving lower divs:",e)}return null}(t,o),a=e,i=n("class");a.replaceChildren(),a.appendChild(i),s.forEach(((e,t)=>{const n=function(e,t){const n=document.createElement("option");return n.textContent=e,n.value=t,n}(h(e),t);a.appendChild(n)})),m(r,c)}function b(e){const{prefix:t,courseNumber:n,courseTitle:o}=e;return{prefix:t,courseNumber:n,courseTitle:o}}function S(e){const t=JSON.parse(e);return t?Object.values(t):null}function E(e,t){const n=[];let o;if(Array.isArray(t))o=t.filter((e=>!e.selected));else if(t&&"object"==typeof t){const{selected:e,...n}=t;o=n}return e.forEach((e=>{const t=Object.values(e)[0],r=function(e){if(e&&e.sendingInstitution){let t;return S(e.sendingInstitution).forEach((e=>{if(Array.isArray(e)&&e[0].name){const{name:n}=e[0];t=n}})),t}return null}(t);t&&t.articulations&&S(t.articulations).forEach((e=>{const t=e.articulation;let c;if(t.course?c=b(t.course):t.series&&(c=function(e){const t=e.conjunction,n=[];return e.courses?(e.courses.forEach((e=>{const{prefix:t,courseNumber:o,courseTitle:r}=e;n.push({prefix:t,courseNumber:o,courseTitle:r})})),s(n,t)):null}(t.series)),JSON.stringify(o)===JSON.stringify(c)){const e=function(e,t){const{sendingArticulation:n}=e;if(n.items){const{items:e}=n;if(!n.noArticulationReason){let o=[];if(e.forEach((e=>{const t=e.items;if(t.length>1){const n=function(e,t){const n=e,o=t,r=[],c=n.padStart(n.length+1," "),a=c.padEnd(c.length+1," ");return o.forEach((e=>{const t=b(e);r.push(t)})),s(r,a)}(e.courseConjunction,t);o.push(n)}else{const e=b(t[0]);o.push(e)}})),e.length>1){const e=function(e){if(e.courseGroupConjunctions){const t=e.courseGroupConjunctions,n=t[t.length-1];if(n&&n.groupConjunction)return n.groupConjunction}return null}(n);o=s(o,e)}return o.push(t),o}}return null}(t,r);n.push(e)}}))})),console.log(n),n}async function v(e,t,n,r,c){let s;if(0!==e.length){s=e.length<29?e.splice(0,e.length-1):e.splice(0,29);try{const i=await async function(e,t){const n=JSON.stringify(e),o=await fetch("https://g4sc52rxwf.execute-api.us-east-2.amazonaws.com/articulation-data",{body:n,method:"POST",headers:{"Content-Type":"application/json"},signal:t}),r=await o.json();return Object.values(r)}(s,n),l=E(i,c);t.push(...i),function(e){e.forEach((e=>{if(e){const t=e[e.length-1],n=e.slice(0,-1),r=function(){const e=document.querySelector(".articulations"),t=document.createElement("div");return t.classList.add("class-list"),t.style.display="flex",t.style.opacity="1",e.append(t),t}();!function(e,t){const n=document.createElement("button");n.type="button",n.textContent=t,e.append(n)}(r,t),n.forEach((e=>{Array.isArray(e)?e.forEach((e=>{"object"==typeof e&&null!==e?o(`${e.prefix} ${e.courseNumber} - ${e.courseTitle}`,r):"string"==typeof e&&function(e,t){const n=document.createElement("p");n.classList.add("connector"),n.textContent=e,t.appendChild(n)}(e,r)})):"object"==typeof e&&null!==e?o(`${e.prefix} ${e.courseNumber} - ${e.courseTitle}`,r):"string"==typeof e&&function(e,t){const n=document.createElement("p");n.classList.add("conjunction"),n.textContent=e,t.appendChild(n)}(e,r)}))}}))}(l),a(t.length,r),await v(e,t,n,r,c)}catch(e){"AbortError"===e.name?console.log("aborted request"):console.error("error processing request:",e)}}}async function C(e,t){const n=[],o=e.slice(),r=e.length,s=new AbortController,{signal:i}=s,u=function(e){let t;return e.forEach((e=>{if(Array.isArray(e))e.forEach((n=>{n.selected&&(t=e.filter((e=>!e.selected)))}));else if("object"==typeof e&&e.selected){const{selected:n,...o}=e;t=o}})),t}(t);console.log(u);const p=h(u);var f;window.addEventListener("beforeunload",(()=>s.abort())),c(l).then((()=>{d.style.opacity=1})),d.style.display="flex",f=p,document.querySelector(".selected-class").textContent=`Articulations for: ${f}`,a(0,r);try{await v(o,n,i,r,u),function(){const e=document.querySelector(".articulations"),t=document.querySelectorAll(".class-list"),n=Array.from(t);0===t.length?function(e){const t=document.createElement("p");t.classList.add("no-articulations"),t.textContent="No articulations found.",e.appendChild(t),t.style.opacity=1}(e):(n.sort(((e,t)=>{const n=e.querySelector("button"),o=t.querySelector("button");return n&&o?n.textContent.localeCompare(o.textContent):0})),n.forEach((t=>{e.appendChild(t)})))}(),console.log("all requests processed"),function(){const e=document.querySelector(".loading-container");e.style.opacity=0,c(e).then((()=>{e.style.display="none"}))}(),sessionStorage.removeItem("selectedLowerDivs")}catch(e){"AbortError"===e.name?console.log("requests aborted due to page unload"):console.error("error processing requests",e)}finally{window.removeEventListener("beforeunload",(()=>s.abort()))}return console.log(n),n}const N=[document.getElementById("four-year"),document.getElementById("major"),document.getElementById("class")],x=N[0],A=N[1],j=N[2],q=document.querySelector(".submit"),$=document.querySelector("dialog"),I=document.querySelector(".close-dialog");document.addEventListener("DOMContentLoaded",(async()=>{for(let e=1;e<N.length;)N[e].parentNode&&(p(N[e].parentNode),e+=1);p(q.parentNode),async function(e){const o=e.parentNode,r=o.querySelector(".loading");i.showModal(),i.style.opacity=1,y(o,r);const c=await async function(){try{const e=(new Date).getTime(),t=864e6,n=localStorage.getItem("fourYears"),o=localStorage.getItem("cacheTimestamp");if(!n||!o){const e="https://cs46plizg2.execute-api.us-east-2.amazonaws.com/four-years";return await g(e,"fourYears")}if(e-new Date(o).getTime()<t)return JSON.parse(n)}catch(e){console.error("error retrieving four years:",e)}return null}(),s=e,a=n("school");s.appendChild(a),c.forEach((e=>{if(e.id<200){const n=t(e.name,e.id,"sending");s.appendChild(n)}})),i.style.opacity=0,i.close(),m(o,r)}(N[0]),await async function(){c(l).then((async()=>{await async function(e){const t=e,n=await fetch("https://api.giphy.com/v1/gifs/translate?api_key=uldN0xaiyhNfeuN7QN98ROsslA7JpaDG&s=loading",{mode:"cors"}),o=await n.json();try{o&&(t.src=o.data.images.original.url)}catch(e){console.log(e)}}(u),u.style.display="block",u.style.opacity=1}))}()})),N[0].addEventListener("input",(()=>{const e=x.options[x.selectedIndex].dataset.sending;(async function(e,o){const r=e.parentElement,c=r.querySelector(".loading");y(r,c);const s=await async function(e){try{const t=`https://cs46plizg2.execute-api.us-east-2.amazonaws.com/major-data/${e}/74`,n=await fetch(t),o=await n.json();return Object.values(o)}catch(t){return console.error(`Error fetching majors for ${e}:`,t),null}}(o),a=e,i=n("major");a.replaceChildren(),a.appendChild(i),s.forEach((e=>{const n=t(e.major,e.key,"key");a.appendChild(n)})),m(r,c)})(A,e),A.replaceChildren(),j.replaceChildren(),p(j.parentNode),p(q.parentNode)})),N[1].addEventListener("input",(()=>{const e=x.options[x.selectedIndex].dataset.sending,t=A.options[A.selectedIndex],{key:n}=t.dataset;j.replaceChildren(),w(j,e,n),p(q.parentNode)})),N[2].addEventListener("change",(e=>{const t=Number(e.target.value);if(""!==t){const e=JSON.parse(sessionStorage.getItem("selectedLowerDivs"));e.forEach(((e,n)=>{const o=e;n===t&&(Array.isArray(o)?o.push({selected:!0}):o.selected=!0)})),sessionStorage.setItem("selectedLowerDivs",JSON.stringify(e))}f(q.parentNode)})),q.addEventListener("click",(async e=>{const t=x.options[x.selectedIndex].dataset.sending,n=A.options[A.selectedIndex].dataset.key;if(p(q.parentNode),j.value){const e=await async function(e,t){const n=[],o=await async function(){try{const e=(new Date).getTime(),t=864e6,n=localStorage.getItem("communityColleges"),o=localStorage.getItem("cacheTimestamp");if(!n||!o){const e="https://cs46plizg2.execute-api.us-east-2.amazonaws.com/community-colleges";return await g(e,"communityColleges")}if(e-new Date(o).getTime()<t)return JSON.parse(n)}catch(e){console.error("error retrieving community colleges:",e)}return null}(),r=e,c=t;return o.forEach((e=>{if(e.id){const t=`https://assist.org/api/articulation/Agreements?Key=74/${e.id}/to/${r}/Major/${c}`;n.push({link:t})}})),n}(t,n),o=sessionStorage.getItem("selectedLowerDivs");l.style.opacity=0,c(l).then((()=>{l.style.display="none"})),o&&await C(e,JSON.parse(o))}e.preventDefault()})),I.addEventListener("click",(()=>{$.close()}))})();